All utilities from here. version 3